import{d as W,A as X,D as Y,r as c,g as Z,E as ee,s as te,y as se,j as _,b as e,c as o,i as $,h as le,F as h,z as y,f as u,t as d,G as ae,n as j,e as oe,w as re,T as ne,o as a,_ as de}from"./index-CwgypZy3.js";import{_ as ie}from"./MainLayout.vue_vue_type_style_index_0_lang-XUBCvz-N.js";import{u as ue}from"./useMemoriesStore-BV_nj3Sj.js";import{g as N}from"./storageUtils-BmULdCNP.js";import"./useThemeStore-h4x-EFC4.js";const me={class:"mb-4 md:mb-6"},xe={key:0,class:"max-w-5xl mx-auto"},ce={class:"animate-pulse"},ge={class:"flex gap-2 md:gap-3 mb-4 md:mb-6"},pe={key:1,class:"max-w-5xl mx-auto"},be={class:"relative w-full h-56 sm:h-64 md:h-80 lg:h-96 rounded-xl md:rounded-2xl overflow-hidden shadow-lg md:shadow-xl mb-4 md:mb-6 group"},ve=["src","alt"],fe={class:"absolute bottom-0 left-0 right-0 p-4 md:p-6 text-white"},he={class:"flex items-center gap-1.5 md:gap-2 mb-2 flex-wrap"},ye={class:"px-2 md:px-3 py-1 rounded-full bg-white/20 backdrop-blur-sm text-xs md:text-sm"},ke={key:0,class:"px-2 md:px-3 py-1 rounded-full bg-pink-500/80 text-xs md:text-sm backdrop-blur-sm flex items-center gap-1"},we={key:1,class:"px-2 md:px-3 py-1 rounded-full bg-black/60 text-xs md:text-sm backdrop-blur-sm flex items-center gap-1"},_e={key:2,class:"px-2 md:px-3 py-1 rounded-full bg-blue-500/80 text-xs md:text-sm backdrop-blur-sm flex items-center gap-1"},je={class:"text-xl md:text-2xl lg:text-3xl font-bold mb-1 md:mb-2 drop-shadow"},Ce={key:0,class:"text-sm md:text-base opacity-90 drop-shadow truncate"},Fe={class:"mb-4 md:mb-6"},Me={class:"flex items-center gap-2 md:gap-3 mb-3 md:mb-4 flex-wrap"},Te={key:0,class:"flex items-center gap-1.5 md:gap-2 text-sm md:text-base text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-800 px-3 md:px-4 py-1.5 md:py-2 rounded-lg shadow-sm"},Ee={class:"truncate max-w-[120px] md:max-w-none"},$e={class:"flex items-center gap-1.5 md:gap-2 text-sm md:text-base text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-800 px-3 md:px-4 py-1.5 md:py-2 rounded-lg shadow-sm"},Se={class:"flex items-center gap-1.5 md:gap-2 text-sm md:text-base text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-800 px-3 md:px-4 py-1.5 md:py-2 rounded-lg shadow-sm"},Ve={key:0,class:"flex flex-wrap gap-1.5 md:gap-2"},ze={key:0,class:"px-2.5 md:px-3 py-1 md:py-1.5 rounded-full text-xs md:text-sm bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"},Ae={class:"space-y-4 md:space-y-6"},De={class:"bg-white dark:bg-gray-800 rounded-xl md:rounded-2xl shadow-sm p-4 md:p-6 border border-gray-100 dark:border-gray-700"},Pe={class:"text-gray-600 dark:text-gray-300 leading-relaxed text-sm md:text-base"},Le={key:0,class:"bg-white dark:bg-gray-800 rounded-xl md:rounded-2xl shadow-sm p-4 md:p-6 border border-gray-100 dark:border-gray-700"},Ne={class:"flex items-center justify-between mb-3 md:mb-4"},Be={class:"flex items-center gap-2"},Ie={class:"text-lg md:text-xl font-semibold text-gray-800 dark:text-gray-100"},Ue={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 md:gap-3"},qe=["onClick"],Re=["src","alt"],Ge={key:0,class:"absolute inset-0 bg-black/50 flex items-center justify-center"},Ke={class:"text-white font-semibold text-sm md:text-base"},He={key:1,class:"bg-white dark:bg-gray-800 rounded-xl md:rounded-2xl shadow-sm p-4 md:p-6 border border-gray-100 dark:border-gray-700"},Je={class:"flex items-center gap-2 mb-3 md:mb-4"},Oe={class:"text-lg md:text-xl font-semibold text-gray-800 dark:text-gray-100"},Qe={class:"space-y-4 md:space-y-6"},We={class:"relative rounded-xl md:rounded-2xl overflow-hidden bg-black shadow-lg transition-all duration-300 group-hover:shadow-xl"},Xe=["src","poster","onClick","onTimeupdate","onLoadedmetadata"],Ye={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-4 transition-opacity duration-300 opacity-0 group-hover:opacity-100"},Ze={class:"w-full h-1.5 bg-gray-600/50 rounded-full mb-3 overflow-hidden"},et={class:"flex items-center justify-between"},tt={class:"flex items-center gap-3"},st=["onClick"],lt={class:"text-sm text-gray-300 font-mono"},at={class:"flex items-center gap-2"},ot=["onClick"],rt=["onClick"],nt=["onClick"],dt={class:"mt-2 px-1"},it={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},ut={key:0,class:"font-mono"},mt={class:"sticky bottom-4 md:static bg-white dark:bg-gray-800 rounded-xl md:rounded-2xl shadow-lg md:shadow-sm p-4 md:p-6 border border-gray-100 dark:border-gray-700 md:mt-6"},xt={class:"grid grid-cols-3 gap-2 md:flex md:gap-3"},ct={class:"w-8 h-8 rounded-lg bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center group-hover:scale-110 transition-transform"},gt={class:"text-xs md:text-sm text-gray-700 dark:text-gray-300"},pt={key:2,class:"max-w-5xl mx-auto text-center py-12 md:py-16"},bt={class:"relative w-full h-full flex items-center justify-center p-4"},vt=["src","alt"],ft={class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/60 backdrop-blur-sm text-white px-4 py-2 rounded-full text-sm flex items-center gap-2"},ht={key:0,class:"absolute bottom-20 left-1/2 transform -translate-x-1/2 flex gap-2"},yt=["onClick"],kt=W({__name:"DetailsIndex",setup(wt){const B=Y(),k=ue(),S=X(),I=B.params.id,l=c(null),V=c(!0),i=c([]),x=c([]),b=c([]),v=c([]),C=c([]),F=c([]),M=c([]),f=c([]),w=c(!1),g=c(0),U=(s,t)=>{s&&b.value[t]!==s&&(b.value[t]=s)},T=s=>{if(!s||isNaN(s))return"0:00";const t=Math.floor(s/60),n=Math.floor(s%60);return`${t}:${n.toString().padStart(2,"0")}`},q=s=>{try{return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return s}},z=s=>{g.value=s,w.value=!0,document.body.style.overflow="hidden"},E=()=>{w.value=!1,document.body.style.overflow="auto"},A=()=>{g.value=(g.value+1)%i.value.length},D=()=>{g.value=(g.value-1+i.value.length)%i.value.length},P=(s,t)=>{s.stopPropagation();const n=b.value[t];n&&(n.paused?(n.play(),v.value[t]=!0):(n.pause(),v.value[t]=!1))},R=s=>{const t=b.value[s];t&&(t.play(),v.value[s]=!0)},G=(s,t)=>{const n=s.target;n&&(M.value[t]=n.currentTime,F.value[t]=n.currentTime/n.duration*100,n.currentTime>=n.duration&&(v.value[t]=!1))},K=s=>{const t=b.value[s];t&&(t.muted=!t.muted,C.value[s]=t.muted)},H=(s,t)=>{s.stopPropagation();const n=b.value[t];n&&(document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():n.requestFullscreen&&n.requestFullscreen())},J=()=>{v.value=new Array(x.value.length).fill(!1),C.value=new Array(x.value.length).fill(!1),F.value=new Array(x.value.length).fill(0),M.value=new Array(x.value.length).fill(0),f.value=new Array(x.value.length).fill(0)},L=s=>{if(w.value)switch(s.key){case"Escape":E();break;case"ArrowLeft":D();break;case"ArrowRight":A();break}},O=s=>{const t=b.value[s];t&&t.duration&&(f.value[s]=t.duration)},Q=async()=>{if(!l.value)return;const s=S.user?.email;s&&(await k.updateMemory(l.value.id,{isFavorite:!l.value.isFavorite},s),l.value.isFavorite=!l.value.isFavorite)};return Z(async()=>{try{const s=S.user?.email;if(!s)return;k.loaded||await k.fetchMemories(s);const t=k.getMemoryById(I);if(!t||t.isDeleted){await ee.push({name:"not-found"});return}l.value=t,l.value.images?.length&&(i.value=await Promise.all(l.value.images.map(async n=>{try{return await N(n)}catch{return"/favicon.jpg"}}))),l.value.images?.length&&(x.value=await Promise.all(l.value.videos.map(async n=>{try{return await N(n)}catch{return""}})),setTimeout(()=>J(),100))}catch(s){console.error("Error loading memory:",s)}finally{V.value=!1}window.addEventListener("keydown",L)}),te(()=>{b.value.forEach(s=>{s&&(s.pause(),s.src="",s.load())}),window.removeEventListener("keydown",L)}),(s,t)=>{const n=le("router-link");return a(),se(ie,null,{default:_(()=>[e("div",me,[$(n,{to:"/private/memories",class:"inline-flex items-center gap-2 text-pink-600 hover:text-pink-700 dark:text-pink-400 dark:hover:text-pink-300 transition-colors text-sm md:text-base"},{default:_(()=>[...t[1]||(t[1]=[e("i",{class:"bx bx-arrow-back text-lg md:text-xl"},null,-1),e("span",{class:"font-medium"},"Back to Memories",-1)])]),_:1})]),V.value?(a(),o("div",xe,[e("div",ce,[t[2]||(t[2]=e("span",{class:"w-full h-56 sm:h-64 md:h-80 lg:h-96 bg-gray-200 dark:bg-gray-700 rounded-xl md:rounded-2xl mb-4 md:mb-6"},null,-1)),t[3]||(t[3]=e("span",{class:"h-7 bg-gray-200 dark:bg-gray-700 rounded-lg w-3/4 mb-3 md:mb-4"},null,-1)),e("div",ge,[(a(),o(h,null,y(4,p=>e("span",{key:p,class:"h-10 bg-gray-200 dark:bg-gray-700 rounded-lg flex-1"})),64))])])])):l.value?(a(),o("div",pe,[e("div",be,[e("img",{src:i.value[0]||"/favicon.jpg",alt:l.value.title,class:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"},null,8,ve),t[7]||(t[7]=e("span",{class:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"},null,-1)),e("div",fe,[e("div",he,[e("div",ye,d(l.value.year),1),l.value.isFavorite?(a(),o("div",ke,[...t[4]||(t[4]=[e("i",{class:"bx bxs-star text-xs md:text-sm"},null,-1),e("span",{class:"hidden sm:inline"},"Favorite",-1)])])):u("",!0),i.value.length>1?(a(),o("div",we,[t[5]||(t[5]=e("i",{class:"bx bx-images text-xs md:text-sm"},null,-1)),e("span",null,d(i.value.length),1)])):u("",!0),x.value.length>0?(a(),o("div",_e,[t[6]||(t[6]=e("i",{class:"bx bx-video text-xs md:text-sm"},null,-1)),e("span",null,d(x.value.length),1)])):u("",!0)]),e("h1",je,d(l.value.title),1),l.value.description?(a(),o("p",Ce,d(l.value.description),1)):u("",!0)])]),e("div",Fe,[e("div",Me,[l.value.location?(a(),o("div",Te,[t[8]||(t[8]=e("i",{class:"bx bx-map text-pink-500"},null,-1)),e("span",Ee,d(l.value.location),1)])):u("",!0),e("div",$e,[t[9]||(t[9]=e("i",{class:"bx bx-calendar text-purple-500"},null,-1)),e("span",null,d(q(l.value.date)),1)]),e("div",Se,[t[10]||(t[10]=e("i",{class:"bx bx-collection text-blue-500"},null,-1)),e("span",null,d(i.value.length+x.value.length)+" media",1)])]),l.value.tags&&l.value.tags.length>0?(a(),o("div",Ve,[(a(!0),o(h,null,y(l.value.tags.slice(0,3),p=>(a(),o("span",{key:p,class:"px-2.5 md:px-3 py-1 md:py-1.5 rounded-full text-xs md:text-sm bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300"},d(p),1))),128)),l.value.tags.length>3?(a(),o("span",ze," +"+d(l.value.tags.length-3),1)):u("",!0)])):u("",!0)]),e("div",Ae,[e("div",De,[t[11]||(t[11]=e("div",{class:"flex items-center gap-2 mb-3 md:mb-4"},[e("div",{class:"w-8 h-8 md:w-10 md:h-10 rounded-lg md:rounded-xl bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center"},[e("i",{class:"bx bx-note text-pink-600 dark:text-pink-400 text-sm md:text-base"})]),e("h2",{class:"text-lg md:text-xl font-semibold text-gray-800 dark:text-gray-100"}," Description ")],-1)),e("p",Pe,d(l.value.description||"No description provided for this memory."),1)]),i.value.length>0?(a(),o("div",Le,[e("div",Ne,[e("div",Be,[t[12]||(t[12]=e("div",{class:"w-8 h-8 md:w-10 md:h-10 rounded-lg md:rounded-xl bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center"},[e("i",{class:"bx bx-images text-blue-600 dark:text-blue-400 text-sm md:text-base"})],-1)),e("h2",Ie," Photos ("+d(i.value.length)+") ",1)]),e("button",{onClick:t[0]||(t[0]=p=>z(0)),class:"text-sm text-pink-600 hover:text-pink-700 dark:text-pink-400 dark:hover:text-pink-300 font-medium"}," View All ")]),e("div",Ue,[(a(!0),o(h,null,y(i.value.slice(0,4),(p,r)=>(a(),o("div",{key:r,onClick:m=>z(r),class:"relative aspect-square rounded-lg md:rounded-xl overflow-hidden cursor-pointer group hover:scale-[1.02] transition-all duration-300"},[e("img",{src:p,alt:`Photo ${r+1}`,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,Re),t[13]||(t[13]=e("div",{class:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-300 flex items-center justify-center"},[e("i",{class:"bx bx-zoom-in text-white text-lg md:text-xl opacity-0 group-hover:opacity-100 transform scale-0 group-hover:scale-100 transition-all duration-300"})],-1)),r===3&&i.value.length>4?(a(),o("div",Ge,[e("span",Ke," +"+d(i.value.length-4),1)])):u("",!0)],8,qe))),128))])])):u("",!0),x.value.length>0?(a(),o("div",He,[e("div",Je,[t[14]||(t[14]=e("div",{class:"w-8 h-8 md:w-10 md:h-10 rounded-lg md:rounded-xl bg-green-100 dark:bg-green-900/30 flex items-center justify-center"},[e("i",{class:"bx bx-video text-green-600 dark:text-green-400 text-sm md:text-base"})],-1)),e("h2",Oe," Videos ("+d(x.value.length)+") ",1)]),e("div",Qe,[(a(!0),o(h,null,y(x.value,(p,r)=>(a(),o("div",{key:r,class:"group"},[e("div",We,[e("video",{ref_for:!0,ref:m=>U(m,r),src:p,class:"w-full h-auto max-h-[500px] object-contain custom-video",poster:i.value[0]||"/favicon.jpg",preload:"metadata",onClick:m=>P(m,r),onTimeupdate:m=>G(m,r),onLoadedmetadata:m=>O(r)},null,40,Xe),e("div",Ye,[e("div",Ze,[e("div",{class:"h-full bg-green-500 rounded-full transition-all duration-200 progress-bar",style:ae({width:`${F.value[r]||0}%`})},null,4)]),e("div",et,[e("div",tt,[e("button",{onClick:m=>P(m,r),class:"w-8 h-8 flex items-center justify-center text-white hover:text-green-400 transition-colors"},[e("i",{class:j(v.value[r]?"bx bx-pause text-xl":"bx bx-play text-xl")},null,2)],8,st),e("div",lt,d(T(M.value[r]||0))+" / "+d(T(f.value[r]||0)),1)]),e("div",at,[e("button",{onClick:m=>K(r),class:"w-8 h-8 flex items-center justify-center text-white hover:text-green-400 transition-colors"},[e("i",{class:j(C.value[r]?"bx bx-volume-mute":"bx bx-volume-full")},null,2)],8,ot),e("button",{onClick:m=>H(m,r),class:"w-8 h-8 flex items-center justify-center text-white hover:text-green-400 transition-colors"},[...t[15]||(t[15]=[e("i",{class:"bx bx-fullscreen"},null,-1)])],8,rt)])])]),v.value[r]?u("",!0):(a(),o("div",{key:0,onClick:m=>R(r),class:"absolute inset-0 flex items-center justify-center cursor-pointer"},[...t[16]||(t[16]=[e("div",{class:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-black/60 backdrop-blur-sm flex items-center justify-center transition-transform duration-300 hover:scale-110 group-hover:opacity-100 opacity-80"},[e("i",{class:"bx bx-play text-3xl md:text-4xl text-white"})],-1)])],8,nt))]),e("div",dt,[e("div",it,[e("span",null,"Video "+d(r+1),1),f.value[r]?(a(),o("span",ut,d(T(f.value[r])),1)):u("",!0)])])]))),128))])])):u("",!0),e("div",mt,[e("div",xt,[e("button",{onClick:Q,class:"flex flex-col md:flex-row items-center gap-1.5 md:gap-2 px-3 py-2.5 md:px-4 md:py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors group"},[e("span",ct,[e("i",{class:j(l.value.isFavorite?"bx bxs-heart text-pink-600 dark:text-pink-400":"bx bx-heart text-gray-400")},null,2)]),e("span",gt,d(l.value.isFavorite?"Unfavorite":"Favorite"),1)]),t[17]||(t[17]=e("button",{class:"flex flex-col md:flex-row items-center gap-1.5 md:gap-2 px-3 py-2.5 md:px-4 md:py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors group"},[e("span",{class:"w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center group-hover:scale-110 transition-transform"},[e("i",{class:"bx bx-share text-blue-600 dark:text-blue-400"})]),e("span",{class:"text-xs md:text-sm text-gray-700 dark:text-gray-300"},"Share")],-1)),t[18]||(t[18]=e("button",{class:"flex flex-col md:flex-row items-center gap-1.5 md:gap-2 px-3 py-2.5 md:px-4 md:py-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors group"},[e("span",{class:"w-8 h-8 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center group-hover:scale-110 transition-transform"},[e("i",{class:"bx bx-edit text-green-600 dark:text-green-400"})]),e("span",{class:"text-xs md:text-sm text-gray-700 dark:text-gray-300"},"Edit")],-1))])])])])):(a(),o("div",pt,[t[20]||(t[20]=e("div",{class:"w-16 h-16 md:w-20 md:h-20 mx-auto mb-4 md:mb-6 rounded-full bg-gradient-to-r from-pink-100 to-purple-100 dark:from-gray-800 dark:to-gray-700 flex items-center justify-center"},[e("i",{class:"bx bx-image text-xl md:text-2xl text-pink-600 dark:text-pink-400"})],-1)),t[21]||(t[21]=e("h2",{class:"text-lg md:text-xl font-bold text-gray-800 dark:text-gray-100 mb-2 md:mb-3"},"Memory Not Found",-1)),t[22]||(t[22]=e("p",{class:"text-sm md:text-base text-gray-600 dark:text-gray-400 mb-6 md:mb-8 max-w-md mx-auto px-4"}," The memory you're looking for doesn't exist or has been removed. ",-1)),$(n,{to:"/private/memories",class:"inline-flex items-center gap-2 px-5 md:px-6 py-2.5 md:py-3 rounded-xl bg-gradient-to-r from-pink-500 to-purple-500 text-white font-semibold text-sm md:text-base hover:shadow-lg hover:scale-[1.02] transition-all duration-300"},{default:_(()=>[...t[19]||(t[19]=[e("i",{class:"bx bx-arrow-back"},null,-1),oe(" Back to Memories ",-1)])]),_:1})])),$(ne,{name:"fade"},{default:_(()=>[w.value?(a(),o("div",{key:0,class:"fixed inset-0 bg-black/95 backdrop-blur-sm flex items-center justify-center z-50",onClick:re(E,["self"])},[e("button",{onClick:E,class:"absolute top-4 right-4 md:top-8 md:right-8 text-white text-3xl hover:text-pink-400 transition-colors z-10"},[...t[23]||(t[23]=[e("i",{class:"bx bx-x"},null,-1)])]),i.value.length>1?(a(),o("button",{key:0,onClick:D,class:"absolute left-4 md:left-8 text-white text-4xl hover:text-pink-400 transition-colors z-10 p-2"},[...t[24]||(t[24]=[e("i",{class:"bx bx-chevron-left"},null,-1)])])):u("",!0),i.value.length>1?(a(),o("button",{key:1,onClick:A,class:"absolute right-4 md:right-8 text-white text-4xl hover:text-pink-400 transition-colors z-10 p-2"},[...t[25]||(t[25]=[e("i",{class:"bx bx-chevron-right"},null,-1)])])):u("",!0),e("div",bt,[e("img",{src:i.value[g.value],alt:`Gallery image ${g.value+1}`,class:"max-h-[85vh] max-w-full object-contain rounded-lg"},null,8,vt),e("div",ft,[e("span",null,d(g.value+1)+" / "+d(i.value.length),1),t[26]||(t[26]=e("span",{class:"text-gray-300"},"•",-1)),e("span",null,d(l.value?.title),1)]),i.value.length>1?(a(),o("div",ht,[(a(!0),o(h,null,y(i.value,(p,r)=>(a(),o("div",{key:r,onClick:m=>g.value=r,class:j(["w-2 h-2 rounded-full cursor-pointer transition-all duration-300",g.value===r?"bg-pink-500 w-4":"bg-white/50 hover:bg-white"])},null,10,yt))),128))])):u("",!0)]),t[27]||(t[27]=e("div",{class:"absolute bottom-4 right-4 text-white/50 text-sm hidden md:block"},[e("span",null,"← → to navigate • Esc to close")],-1))])):u("",!0)]),_:1})]),_:1})}}}),Tt=de(kt,[["__scopeId","data-v-b12332c7"]]);export{Tt as default};
